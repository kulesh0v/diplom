\chapter{ОСНОВНЫЕ ПОНЯТИЯ И ОБЗОР ЛИТЕРАТУРЫ }\label{chap1}
В настоящей главе описываются основные понятия управления по прогнозирующей модели, а также приводится классификация задач оптимального управления, используемых в современной теории управления.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Теория управления по прогнозирующей модели}\label{1sec:MPC}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Главная идея MPC \cite{Mayne} -- использование математической модели управляемого процесса в пространстве состояний для предсказания и оптимизации будущего поведения системы.
Рассмотрим задачу стабилизации нелинейной системы 
\begin{equation}\label{x(t+1)}
	x(t+1)=f(x(t),u(t)),\, t=0,1,\dots,
\end{equation}
где 
\newline
	$x=x(t) \in \mathbb{R}^n$ -- состояние системы в момент времени $t$;\newline
	$u=u(t) \in \mathbb{R}^r$ -- значение управляющего воздействия в момент времени $t$;
$f: \mathbb{R}^n \times \mathbb{R}^r \rightarrow \mathbb{R}^n$ -- заданная функция.
\par Пусть $f(0,0)=0$, следовательно точка равновесия системы находится в начале координат, и при тривиальном управлении $u\equiv0$ система остаётся в состоянии покоя.
\par При заданном управлении $u(\cdot)$, траектория системы (\ref{x(t+1)}) обозначается как $x(t|0,z,u(\cdot)), \, t=0,1,\dots$, где начальное состояние системы в момент времени $t=0$ задаётся условием $x(0)=z$.
\par Управление $u(\cdot)$ будем выбирать так, чтобы максимально приблизить траектории $x(t|0,x_0,u(\cdot)), \, t=0,1,\dots,N,$ к началу координат.

\newtheorem{Def}{Определение}
\begin{Def}
	Стоимость этапа -- функция $l(x(t),u(t))$ вдоль траектории $x(\cdot)$ и управления $u(\cdot)$, с помощью которой для всех моментов времени $t=0,1,\dots$ оценивается качество выбранного урпавления $u(\cdot)$.
\end{Def}

Чаще всего стоимость этапа $l$ выбирается следующим образом:
\begin{enumerate}
	\item Взвешенная сумма расстояний до начала координат:
	\begin{center}
		$l(x,u)=\parallel x\parallel ^2+\lambda\parallel u\parallel ^2, \quad
\lambda \geq 0$ -- параметр, $\parallel \cdot \parallel$ -- евклидова норма.
	\end{center}
	\item Квадратичные функции
	\begin{center}
		$l(x,u)=x'Qx+u'Ru$
	\end{center}
$R,Q>0$ -- положительно-определённые матрицы.
\end{enumerate}
\bigskip

Таким образом задача оптимального управления состоит в минимизации функционала, где минимум ищем вдоль траекторий $x(t|0,x^*(\tau),u(\cdot)), t=0,1,\dots, N-1$, системы (\ref{x(t+1)}) с начальным состоянием, совпадающим с текущим состоянием объекта $x(0)=x^*(\tau)$ и при некоторых ограничениях:
\begin{equation}\label{J(x^*(tau))}
	J(x^*(\tau))=\min_{u(\cdot)}\sum_{t=0}^{N-1} l(x(t|0,x^*(\tau),u(\cdot)),u(t)).
\end{equation}

Ограничения для задачи (\ref{J(x^*(tau))}) состояит из двух групп:
\begin{enumerate}
 \item Физические ограничения системы (например, неотрицательность переменных, максимальное ограничение на управляющее воздействие и другие);
 \item Ограничения, накладываемые алгоритмом MPC (например, терминальное ограничение вида $x(N)=0$ или принадлежность $x(N)$ множеству $X_f$).
\end{enumerate}

Обозначим оптимальное программное решение задачи (\ref{J(x^*(tau))}) через $u^0(\cdot|x^*(\tau))$. Для построения обратных связей будем считать, что на объект
управления подано первое значение оптимальной программы 
\begin{center}
	$\mu(x^*(\tau))=u^0(0|x^*(\tau)).$
\end{center}

Далее в момент времени $\tau + 1$ процесс повторяется для состояния
$x^*(\tau+1)$. Тогда в этот момент времени решается задача о минимизации следующего функционала:
\begin{center}
	$
	J(x^*(\tau+1))=\underset{{u(\cdot)}}\min\sum_{t=0}^{N-1} l(x(t|0,x^*(\tau+1),u(\cdot)),u(t)).$
\end{center}


При этом будет получено очередное значение обратной связи:
\begin{displaymath}
	\mu(x^*(\tau+1))=u^0(0|x^*(\tau+1)).
\end{displaymath}
После процесс повторяется при $\tau + 2, \tau + 3$ и так далее.
Таким образом, алгоритм управления по прогнозирующей модели, в каждый момент времени $\tau = 0,1,\dots$ состоит из следующих шагов:
\begin{enumerate}
	 \item Измеряется текущее состояние $x^*(\tau)$
	 \item Находится оптимальное программное решение $u^0(t|x^*(\tau))$ задачи (\ref{J(x^*(tau))}).
	 \item Подаётся на объект системы управляющее воздействие 
	\begin{center}
		 $\mu^*(\tau)  \equiv \mu(x^*(\tau))=\mu^0(0|x^*(\tau))$.
	\end{center}		 
\end{enumerate}

\indent Идея упрваления по прогнозирущей модели заключается в оптимизации будущего поведения системы в каждый момент времени, нахождение оптимального управления и его использования в качестве значений обратной связи для следующего момента времени.


\section{Задачи оптимального управления}\label{2sec:POC}

Задачи оптимального управления классифицируются \cite{Alsevich}
\begin{itemize}
	\item По промежутку управления:
	\begin{itemize}
		\item задачи оптимального управления разделяются на непрерывные $T = [t_0,t_f]$ и дискретные, в которых динамический процесс рассматривается в дискретные моменты времени $k=0,1,\dots,N, \: N $ --  натуральное число.	
		\item задачи различаются по продолжительности процесса  с фиксированным и нефиксированном $t_f$. 


	\end{itemize}
	\item По ограничениям на траекторию, которые в общем виде имеют следующий вид:
	\begin{center}
		$x\in\mathbb{X}(t), t\in[t_0,t_f]$.
	\end{center}
	Ограничения на траекторию могут накладываться:
	\begin{itemize}
		\item на правом конце траектории(терминальные ограничения), т.е. $x(t_f)\in\mathbb{X}_f$;
		\item на левом конце, т.е. $x(t_0)\in\mathbb{X}_0$;
		\item  в промежуточные моменты времени, т.е. $x(t_i)\in\mathbb{X}_i,t_i\in[t_0,t_f],i=1,...,l$, при этом $t_0<t_1<\dots<t_l<t_f.$
	\end{itemize}
	Также существуют смешанные ограничения на траекторию.
	\item По критерию качества: \\
	\begin{itemize}
	\item Терминальный критерий качества типа Майера
	\begin{displaymath}
		J(u)=\varphi(x(t_f)),
	\end{displaymath}
	\begin{displaymath}
		 \varphi: R^n \rightarrow R.
	\end{displaymath}
	\item Интегральный критерий типа Лагранжа
	\begin{displaymath}
 		J(u)=\int\limits_{t_0}^{t_f} f_0(x(t),u(t),t) \,dt,
	\end{displaymath}
 	\begin{displaymath}	
		f_0\, : \,R^n \times R^r \times R \rightarrow R.
	\end{displaymath}
	\item Критерий качества типа Бальса
		\begin{displaymath}
			J(u)=\varphi(x(t_f))+\int\limits_{t_0}^{t_f} f_0(x(t),u(t),t) \,dt.
		\end{displaymath}
	\item Критерий быстродействия
	\begin{displaymath}
		J(u)=t_f-t_0 \rightarrow \min.
	\end{displaymath}
	\end{itemize}
\end{itemize}

Принцип максимума -- классическое необходимое условие оптимальности для задач оптимального управления. Оно является самым сильным из известных необходимых условий оптимальности первого порядка.

Для формулировки принципа максимума введем гамильтониан:
\begin{displaymath}
	H(x,\psi,u,t)=\psi'f(x,u,t)=\sum^n_{j=1}\psi_j f_j(x,u,t)
\end{displaymath}

Рассмотрим простейшую задачу оптимального управления на промежутке времени $[t_0,t_f]$ в классе кусочно-непрерывных управлений:
\begin{displaymath}
	J(u)=\phi(x(t_f))\rightarrow\min,
\end{displaymath}
\begin{displaymath}
	\dot{x}=f(x,u,t),x(t_0)=x_0,
\end{displaymath}
\begin{displaymath}
	u(t)\in\mathbb{U},t\in[t_0,t_f].
\end{displaymath}
 Пусть $u^0(t), t\in[t_0,t_f]$, -- оптимальное управление, $x^0(t),t\in [t_0,t_f]$, -- оптимальная траектория, $\psi^0(t),t\in [t_0,t_f]$ -- сопряжённая траектория -- решение сопряженного уравнения
\begin{displaymath}
	\dot{\psi}=-\frac{\partial H(x^0(t),\psi,u^0(t),t)}{\partial x},\end{displaymath}
\begin{displaymath}
	\psi=-\frac{\partial \varphi(x^0(t_f)}{\partial x}.\end{displaymath}
	Тогда выполняется условие максимума гамильтониана:
\begin{displaymath}
	H(x^0(t),\psi^0(t),u^0(t),t)=\underset{u\in\mathbb{U}}\max H(x^0(t),\psi^0(t),u,t),t\in[t_0,t_f].
\end{displaymath}