\chapter{Управление по прогнозирующей модели на основе данных: неточные данные}\label{chap3}

Применение схемы MPC из  Главы \ref{chap2} может привести к проблемам с существованием решения или может сделать замкнутый контур неустойчивым. В этой главе  мы рассмотрим проблему зашумленных измерений из \cite{Berberich} с помощью робастной схемы MPC с терминальными ограничениями.

\section{Робастная схема MPC с терминальными ограничениями}

На практике выходной сигнал неизвестной системы G обычно является неточным. Это означает, что сложенные матрицы Ганкеля, зависящие от данных, в \ref{formuleOfTrajectoryTheorem} не покрывают пространство траекторий системы точно и, следовательно, выходные траектории не могут быть точно предсказаны. Более того, измерения выходного сигнала с зашумлением входят в начальные условия в задаче (\ref{problem2a}-\ref{problem2e}), что еще больше ухудшает точность прогноза. 

В данной главе будет предполагаться, что выходные сигналы с ограниченным аддитивным шумом находятся в изначально доступных данных $\widetilde{y}^d_k=y^d_k+\varepsilon^d_k$ и в измерениях $\widetilde{y}_k=y_k+\varepsilon_k$. Мы не делаем никаких предположений о природе шума, но требуем, чтобы он был ограничен как $\|\varepsilon^d_k\|_\infty\leq \overline{\varepsilon}$ и $\|\varepsilon_k\|_\infty\leq \overline{\varepsilon}$ для некоторого $\overline{\varepsilon}$. Ключевой идеей для учета зашумленных измерений является ослабление ограничения равенства (\ref{problem2b}). При зашумленной начальной траектории $(u_{[t-n,t-1]},\widetilde{y}_{[t-n,t-1]})$ длины $n$, предлагается следующая надежная модификация (\ref{problem2a}-\ref{problem2e}).

\begin{equation}\label{problem3a}
		J^*_L(u_{[t-n,t-1]},\widetilde{y}_{[t-n,t-1]}) = \underset{\substack{\alpha(t),\overline{u}(t),\overline{y}(t), \sigma(t)}} \min \sum^{L-1}_{k=0}\ell(\overline{u}_k(t),\overline{y}_k(t)) + \lambda_\alpha \overline{\varepsilon}\|\alpha(t)\|^2_2 + \lambda_\sigma \|\sigma(t)\|^2_2
\end{equation}
\begin{equation}\label{problem3b}
	\begin{bmatrix}
		\overline{u}(t)\\
		\overline{y}(t) + \sigma(t)
	\end{bmatrix} = 
	\begin{bmatrix}
		H_{L+n}(u^d) \\ 
		H_{L+n}(\widetilde{y}^d)
	\end{bmatrix}\alpha(t),	
\end{equation}
\begin{equation}\label{problem3c}
	\begin{bmatrix}
		\overline{u}_{[-n,-1]}(t) \\ 
		\overline{y}_{[-n,-1]}(t) 
	\end{bmatrix} = 
	\begin{bmatrix}
		u_{[t-n,t-1]} \\
		y_{[t-n,t-1]}
	\end{bmatrix},
\end{equation}
\begin{equation}\label{problem3d}
	\begin{bmatrix}
		\overline{u}_{[L-n,L-1]}(t) \\ 
		\overline{y}_{[L-n,L-1]}(t) 
	\end{bmatrix} = 
	\begin{bmatrix}
		u_{n}^s \\
		y_{n}^s
	\end{bmatrix}, \overline{u}_k \in \mathbb{U},
\end{equation}
\begin{equation}\label{problem3e}
	\|\sigma_k(t)\|_\infty \leq \overline{\varepsilon}(1+ \| \alpha(t) \|_1), k \in \mathbb{I}_{[0,L-1]}.
\end{equation}
По сравнению с задачей (\ref{problem2a}-\ref{problem2e}) траектория выходных данных $\widetilde{y}^d$ и начальный выходной сигнал $\widetilde{y}_{[t-n,t-1]}$, полученные из онлайн измерений, были заменены их зашумленными аналогами.
Также были добавлены следующие элементы:
\begin{enumerate}
	\item Вспомогательная переменная $\sigma$ для олнайн измерений $\widetilde{y}_{[t-n,t-1]}$ и для зашумленных данных $\widetilde{y}^d$, используемых для предсказаний.
	\item Квадратичная норма для $\sigma$ и $\alpha$ с весами $\lambda_\alpha \overline{\varepsilon}, \lambda_\sigma > 0$, норма $\alpha$ зависит от уровня шума.
\end{enumerate}

Приведенная выше регуляризация по $l_2$-норме для $\alpha(t)$ означает, что предпочтительны небольшие значения 	$\|\alpha(t)\|_2^2$.
Поскольку зашумленная матрица Ганкеля $H_{L+n}(\widetilde{y}^d)$ умножается на $\alpha(t)$ в (\ref{problem3b}), это неявно снижает влияние шума на точность предсказания. Интуитивно понятно, что при увеличение $\lambda_\alpha$ член $\lambda_\alpha\overline{\varepsilon}\|\alpha(t)\|_2^2$ снижает сложность описания системы (\ref{problem3b}), аналогично методам регуляризации в линейной регрессии, что позволяет найти компромисс между производительностью отслеживания и избежанием переобучения. Для наших теоретических результатов $\lambda_\sigma$  может быть выбрано равным нулю, поскольку $\sigma(t)$ уже становится малым из-за ограничения (\ref{problem3e}). Однако, как мы обсудим более подробно в замечании \ref{ch2-r2}, ограничение (\ref{problem3e}) невыпукло, но им можно пренебречь, если $\lambda_\sigma$ достаточно большое. Выбор норм в ограничении (\ref{problem3e}) не зависит от норм в стоимости и следует из оценки $l_\infty$-шума и доказательства верхней границы функции цены (лемма 1 в \cite{Berberich}) и
рекурсивной выполнимости (предложение 1 в \cite{Berberich}).

\section{n-Шаговая схема управления на основе MPC}
В этой главе мы рассматриваем управление по замкнутому контуру, полученное в результате применения (\ref{problem3a}-\ref{problem3e}) в $n$-шаговой схеме MPC. Чтобы быть более точным, мы рассматриваем сценарий, в котором сразу после решения (\ref{problem3a}-\ref{problem3e}) первые $n$ вычисленных входных сигналов применяются к системе. После этого горизонт сдвигается на $n$ шагов, прежде чем вся схема повторяется.

\begin{algorithm}\label{Alg2}(n-Шаговая схема управления на основе MPC)
	\begin{enumerate}
		\item В момент времени $t$ взять прошлые $n$ измерений $\{u_{[t-n,t-1]}, \widetilde{y}_{[t-n,t-1]}\}$  и решить задачу (\ref{problem3a})-(\ref{problem3e}).
		\item Взять за управление $u_{[t,t+n-1]}=\overline{u}_{[t,n-1]}^*(t)$
		\item Установить $t=t+n$ и вернуться к пункту 1).
	\end{enumerate}
\end{algorithm}

Задача (\ref{problem3a} - \ref{problem3e}) - это строго выпуклая квадратичная задача и она может быть эффективно решена. Однако ограничение на $\sigma$ в (\ref{problem3e}) невыпукло из-за зависимости правой части от $\|\alpha(t)\|_1$, что затрудняет эффективную реализацию (\ref{problem3a} - \ref{problem3e}).(\ref{problem3e}) требуется для доказательства рекурсивной выполнимости и практической экспоненциальной устойчивости. Однако его можно заменить (выпуклым) ограничением $\|\sigma_k(t)\|_\infty\leq c \cdot \overline{\varepsilon}$ для достаточно большой постоянной $c > 0$ $с$ сохранением тех же теоретических гарантий. Как правило, больший выбор $c$ увеличивает область притяжения, но также увеличивает размер экспоненциально устойчивого множества, к которому сходится замкнутый контур. Кроме того, ограничение (\ref{problem3e}) может быть реализовано неявно, выбирая $\lambda_\sigma$ достаточно большим. В примерах моделирования было замечено, что ограничение (\ref{problem3e}) обычно выполняется (для достаточно большого выбора $\lambda_\sigma$), не применяя его явно в задаче оптимизации, и, таким образом, в большинстве случаев им можно пренебречь при онлайн-оптимизации.

\begin{Remark}\label{ch2-r1} 
	Вспомним номинальный случай из главы \ref{chap2}, где $\overline{\varepsilon}=0$, что в условиях новой задачи означает, что в (\ref{problem3e}) $\sigma=0$.
	Также при $\overline{\varepsilon}=0$ исчезнет регуляризация $\alpha$,
а динамика системы (\ref{problem3b}) и начальные условия (\ref{problem3c}) приблизятся к своим номинальным аналогам. Таким образом, при $\overline{\varepsilon}=0$ задача (\ref{problem3a} - \ref{problem3e}) сводится к номинальной задаче (\ref{problem2a} - \ref{problem2e}).
\end{Remark}

\begin{Remark}\label{ch2-r2}
	Если ограничением (\ref{problem3e}) пренебречь, а множество $\mathbb{U}$ является выпуклым многогранником, то задача (\ref{problem3a} - \ref{problem3e}) представляет собой строго выпуклую квадратичную программу и может быть эффективно решена. Однако ограничение на величину запаса $\sigma$ в (\ref{problem3e}) невыпукло из-за зависимости правой части от $\|\alpha(t)\|_1$, что затрудняет эффективную реализацию (\ref{problem3a} - \ref{problem3e}). Однако, (\ref{problem3e}) можно заменить выпуклым ограничением $\|\sigma_k(t)\|_\infty \leq c \cdot \overline{\varepsilon}$
для достаточно большой постоянной $c > 0$, сохранив те же теоретические гарантии. Как правило, больший выбор c увеличивает область притяжения, но также увеличивает размер экспоненциально устойчивого множества, к которому сходится замкнутый контур. Кроме того, ограничение (\ref{problem3e}) может быть реализовано неявно, если выбрать достаточно большое значение $\lambda_\sigma$. В примерах моделирования было замечено, что ограничение (\ref{problem3e}) обычно выполняется (для достаточно большого выбора $\lambda_\sigma$), не применяя его явно в задаче оптимизации, и, таким образом, им в большинстве случаев можно пренебречь при онлайн-оптимизации.
\end{Remark}


